esphome:
  name: rpico
  friendly_name: RPico

rp2040:
  board: rpipicow

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: "4pMETk5KXopZcvHt/uJRer7DpK3frYu9Ia08LAhmitY="

ota:
  - platform: esphome
    password: "fa311769bd0aec9f97373dddfda12a34"

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Enable fallback hotspot in case wifi connection fails
  ap:
    ssid: "Rpico Fallback Hotspot"
    password: !secret fallback_password
    
i2c:
  sda: GPIO20
  scl: GPIO21
  scan: true
  id: bus_0
  frequency: 800kHz
  timeout: 10ms

sensor:
  - platform: adc
    pin: TEMPERATURE
    name: "Core Temperature"
    unit_of_measurement: "Â°C"
    filters:
      - lambda: return 27 - (x - 0.706f) / 0.001721f;

  - platform: bme280_i2c
    temperature:
      name: "BME280 Temperature"
    pressure:
      name: "BME280 Pressure"
    humidity:
      name: "BME280 Humidity"    

  - platform: adc
    pin: GPIO26
    id: adc0
    name: "Source for resistance"
    update_interval: 10s
  - platform: resistance
    sensor: adc0
    id: wv_resistance
    configuration: DOWNSTREAM
    resistor: 10.0kOhm

    name: Resistance Sensor    

  - platform: template
    icon: mdi:windsock
    name: "Wind Direction"
    id: wind_direction
    lambda: |-
      if (id(wv_resistance).state > 200000)
      {
        return -1;     //error state = probably disconnected
      }
      else if (id(wv_resistance).state > 90000)
      {
        return 270;
      }
      else if(id(wv_resistance).state > 55000)
      {
        return 315;
      }
      else if(id(wv_resistance).state > 40000)
      {
        return 292.5;
      }
      else if(id(wv_resistance).state > 30000)
      {
        return 0;
      }
      else if(id(wv_resistance).state > 20000)
      {
        return 337.5;
      }
      else if(id(wv_resistance).state > 15000)
      {
        return 225;
      }
      else if(id(wv_resistance).state > 10000)
      {
        return 247.5;
      }
      else if(id(wv_resistance).state > 8000)
      {
        return 45;
      }
      else if(id(wv_resistance).state > 6000)
      {
        return 22.5;
      }
      else if(id(wv_resistance).state > 3500)
      {
        return 180;
      }
      else if(id(wv_resistance).state > 3000)
      {
        return 202.5;
      }
      else if(id(wv_resistance).state > 2000)
      {
        return 135;
      }
      else if(id(wv_resistance).state > 1300)
      {
        return 157.5;
      }
      else if(id(wv_resistance).state > 950)
      {
        return 90;
      }
      else if(id(wv_resistance).state > 800)
      {
        return 67.5;
      }
      else if(id(wv_resistance).state > 600)
      {
        return 112.5;
      }
      else
      {
        return -1;    //resistance too low
      };


status_led:
  pin:
    number: GPIO25
    id: onboard_led
    inverted: false
